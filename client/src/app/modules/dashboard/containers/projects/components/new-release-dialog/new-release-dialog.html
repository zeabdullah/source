<p-dialog
    [visible]="visible()"
    (onHide)="onHide()"
    [modal]="true"
    [draggable]="false"
    [resizable]="false"
>
    <ng-template #header>
        <h3 class="text-h3 font-bold text-gray-900">Create a new release</h3>
    </ng-template>

    <p class="mb-6 max-w-[480px] text-button/normal text-gray-500">
        Save a snapshot of your project's current screens, flows, and campaigns to track changes
        over time.
    </p>

    <form [formGroup]="dialogForm" class="flex flex-col gap-4">
        <div class="flex flex-col gap-1.5">
            <label for="version" class="text-label-text font-semibold">Version tag*</label>
            <div class="relative">
                <input
                    pInputText
                    id="version"
                    name="version"
                    formControlName="version"
                    placeholder="1.2.1"
                    fluid
                />
            </div>
        </div>

        <div class="flex flex-col gap-1.5">
            <label for="description" class="text-label-text font-semibold">
                Description / Notes
            </label>
            <textarea
                pTextarea
                id="description"
                name="description"
                formControlName="description"
                placeholder="Add context about this release (e.g., goals, changes, or scope)."
                [rows]="7"
                class="resize-none"
                fluid
            ></textarea>
        </div>

        <div class="flex flex-col gap-1.5">
            <label for="tags" class="text-label-text font-semibold">Tags</label>
            <p-autocomplete
                formControlName="tags"
                id="tags"
                name="tags"
                [typeahead]="false"
                multiple
                fluid
                placeholder="Add tags..."
            />
        </div>

        <div class="flex flex-col gap-1.5">
            <label for="compare" class="text-label-text font-semibold">Compare</label>
            <div class="flex flex-col gap-1">
                <p-select
                    formControlName="compare"
                    id="compare"
                    name="compare"
                    [options]="compareOptions"
                    placeholder="Select a previous release"
                    appendTo="body"
                    fluid
                />
                <p-message severity="secondary" variant="simple">
                    Select a previous release to compare against.
                </p-message>
            </div>
        </div>

        <div class="flex flex-col gap-1.5">
            <label for="screens" class="text-label-text font-semibold">Screens</label>
            <div class="flex flex-col gap-1">
                <p-multiselect
                    formControlName="screens"
                    id="screens"
                    name="screens"
                    [options]="screenOptions"
                    placeholder="Select screens..."
                    display="chip"
                    appendTo="body"
                    fluid
                    showClear
                />
            </div>
        </div>

        <div class="flex flex-col gap-1.5">
            <label for="emails" class="text-label-text font-semibold">Emails</label>
            <div class="flex flex-col gap-1">
                <p-multiselect
                    formControlName="emails"
                    id="emails"
                    name="emails"
                    [options]="emailOptions"
                    placeholder="Select emails..."
                    display="chip"
                    appendTo="body"
                    fluid
                    showClear
                />
            </div>
        </div>
    </form>

    <ng-template #footer>
        <div class="flex justify-end gap-2">
            <p-button
                label="Cancel"
                variant="outlined"
                severity="secondary"
                (onClick)="onHide()"
                size="large"
            />
            <p-button
                label="Create Release"
                icon="pi pi-check"
                iconPos="right"
                (onClick)="createRelease()"
                [disabled]="!dialogForm.valid || isCreating()"
                [loading]="isCreating()"
                size="large"
            />
        </div>
    </ng-template>
</p-dialog>
