<div
    class="group relative overflow-hidden rounded-xl border border-black/10 bg-white p-6 transition-all duration-300 hover:shadow-lg"
>
    <div class="flex items-start justify-between">
        <div class="flex-1">
            <h3 class="mb-2 text-h4 font-bold text-gray-900">{{ audit().name }}</h3>
            @if (audit().description) {
                <p class="text-body/normal text-gray-600 mb-4">{{ audit().description }}</p>
            }

            <div class="mb-4 flex items-center gap-2">
                <p-tag [value]="statusLabel()" [severity]="statusSeverity()" />
                @if (audit().overall_score !== null) {
                    <span class="text-sm font-medium text-gray-500">
                        Score: {{ audit().overall_score }}/10
                    </span>
                }
            </div>

            <div class="mb-4 text-sm text-gray-500">
                <p>
                    {{ audit().screens.length || 0 }} screen{{
                        audit().screens.length !== 1 ? 's' : ''
                    }}
                </p>
                <p>Created {{ audit().created_at | date: 'short' }}</p>
            </div>
        </div>

        <div class="flex items-center gap-2">
            @if (canExecute()) {
                <p-button
                    icon="pi pi-play"
                    size="small"
                    variant="outlined"
                    severity="secondary"
                    (onClick)="executeAudit()"
                    styleClass="opacity-0 group-hover:opacity-100 transition-opacity"
                />
            }

            <p-menu [model]="menuItemsList" [popup]="true" #menu appendTo="body" />
            <p-button
                icon="pi pi-ellipsis-v"
                size="small"
                variant="text"
                severity="secondary"
                (onClick)="menu.toggle($event)"
            />
        </div>
    </div>

    @if (audit().status === 'processing') {
        <div class="absolute inset-0 flex items-center justify-center bg-white/80">
            <div class="flex flex-col items-center gap-2">
                <p-progress-spinner strokeWidth="3" styleClass="w-8 h-8" />
                <span class="text-gray-600 text-sm font-medium">Processing...</span>
            </div>
        </div>
    }
</div>
